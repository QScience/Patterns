<?xml version="1.0" encoding="ISO-8859-1"?>
<pattern>
  <info>
    <title>Tickets</title>
    <description>This pattern sets up ticketing functionality.</description>
    <author>Chris Bryant</author>
    <author_email>chris@graviteklabs.com></author_email>
    <version>0.1</version>
    <author_date>09.11.2008</author_date>
    <core>5.x</core>      
  </info>
  
  <!-- Enable required modules. -->
  <modules>
    <module>content</module>
    <module>taxonomy</module>
    <module>views</module>
    <module>nodereference</module>
    <module>menu</module>
  </modules>

  <actions>
	  <!-- List of other required patterns to enable -->
	  
    <pattern>additional_modules</pattern>
    <pattern>companies</pattern>
    <pattern>contacts</pattern>
    <pattern>projects</pattern>
    
    
    <!-- Setup Content Types -->
    
    <!-- Create ticket content type -->
    <content>
      <name>Ticket</name>
      <type>ticket</type>
      <description>Ticket content type</description>
      <status>status</status>
      <promote>false</promote>
      <comment>0</comment>
      <upload>1</upload>
    </content>
    <!-- Create field groups -->
    <group>
	    <type>ticket</type>
	    <name>ticket_details</name>
	    <label>Ticket Details</label>
	    <form>
		    <style>fieldset_collapsible</style>
		    <description>Basic ticket details</description>
	    </form>
    </group>
    
    <!-- Setup fields -->
    <field>
	    <type>ticket</type>
	    <name>project</name>
	    <label>Project</label>
	    <widget>nodereference_select</widget>
	    <option>nodereference</option>
	    <!-- <group>ticket_details</group> -->
	    <required>true</required>
	    <multiple>false</multiple>
	    <referenceable_types>
		    <project/>  <!-- This is name of the content type -->
	    </referenceable_types>
	    <weight>-9</weight>
    </field>
    
    
    <!-- Setup Taxonomy -->
    
    <vocabulary>
	    <name>Priority</name>
	    <hierarchy>0</hierarchy> <!-- No Hierarchy -->
	    <multiple>0</multiple>
	    <nodes>
		    <ticket /> <!-- Put the name of the content type -->
	    </nodes>
    </vocabulary>
    <!-- Taxonomy terms -->
    <term vocabulary="Priority">High</term>
    <term vocabulary="Priority">Normal</term>
    <term vocabulary="Priority">Low</term>

    <vocabulary>
	    <name>Ticket Type</name>
	    <hierarchy>0</hierarchy> <!-- No Hierarchy -->
	    <multiple>0</multiple>
	    <nodes>
		    <ticket /> <!-- Put the name of the content type -->
	    </nodes>
    </vocabulary>
    <!-- Taxonomy terms -->
    <term vocabulary="Ticket Type">To-Do</term>
    <term vocabulary="Ticket Type">Bug</term>
    
    <vocabulary>
	    <name>Component</name>
	    <multiple>0</multiple>
	    <hierarchy>0</hierarchy> <!-- No Hierarchy -->
	    <nodes>
		    <project /> <!-- Put the name of the content type -->
	    </nodes>
    </vocabulary>
    <!-- Taxonomy terms -->
    <term vocabulary="Component">Content</term>
    <term vocabulary="Component">Design</term>
    <term vocabulary="Component">Development</term>
    <term vocabulary="Component">QA</term>
    
    <menu>
	    <parent>Primary Links</parent>
	    <title>Tickets</title>
	    <path>tickets</path>
	    <weight>-4</weight>
    </menu>
    
                    <!-- Setup companies view -->
    <view>
      <name>tickets</name>
      <description>Listing of tickets</description>
      <page>
        <enabled>1</enabled>
        <title>Tickets</title>
        <type>teaser</type>
        <numnodes>25</numnodes>
        <pager>true</pager>
        <empty>There are currently no tickets.</empty>
      </page>
      <url>tickets</url>
      <block>
        <enabled>1</enabled>
        <title>Tickets</title>
        <type>list</type>
        <numnodes>8</numnodes>
        <more>true</more>
      </block>
      <field>
	      <id>node.title</id>
      </field>
      <filter>
        <type>node.type</type>
        <operator>OR</operator>
        <value>
          <type>ticket</type> <!-- The name of the your content type goes here. -->
        </value>
      </filter>
      <filter>
        <type>node.status</type>
        <operator>=</operator>
        <value>1</value>
      </filter>
      <sort>
        <type>node.created</type>
        <value>descending</value>
      </sort>
    </view>

    <!-- Setup Blocks -->
    
    <block id="views-tickets">
	    <theme>sky</theme>
	    <status>1</status>
	    <weight>-5</weight>
	    <region>left</region>
    </block>

  </actions>
</pattern>
